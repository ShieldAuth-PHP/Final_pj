import joblib
import numpy as np

# 저장된 모델 로드
model = joblib.load("malware_model.pkl")

def extract_features(file_path):
    """ 파일의 바이너리 데이터를 분석하여 특징을 추출하는 함수 """
    with open(file_path, "rb") as f:
        byte_data = f.read()

    # 바이너리 데이터를 벡터화 (간단한 예제)
    feature_vector = np.array([len(byte_data), sum(byte_data) % 256, max(byte_data)])
    return feature_vector.reshape(1, -1)

def predict_malware(file_path):
    features = extract_features(file_path)
    prediction = model.predict(features)[0]

    if prediction == 1:
        return "malicious"
    elif prediction == 0:
        return "benign"
    else:
        return "suspicious"